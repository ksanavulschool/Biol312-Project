---
title: "Wages and Education of Young Males"
author: "Richard Yoder, Johnny Sandy, Kyle Sanavullah"
date: "4/21/2022"
output: pdf_document
---
```{r, message=FALSE}
setwd("C:/Users/Owner/Documents/R/BIOL 312 Biostatistics for Bioinformatics/Final Project")

cat("\014") # Clears Console
rm(list=ls()) # Clears Environment
dev.off() # Clears Plots
graphics.off() # Clears Plots if first one didn't work.
```

#Libraries
```{r, message=FALSE}
library(tidyverse)
library(dplyr)
library(modelr)
```

#Data
```{r, message=FALSE}
rm(list=ls()) # Clears Environment
Males <- read_csv("Males.csv")
```

#Cleaning
##Data headings
```{r}
Males <- Males %>% 
  rename(Person_ID = "nr",
         experience = "exper",
         ethnicity = "ethn",
         married = "maried",
         union_membership = "union")
```

#Setting Data to tibble
```{r}
#Males<- tidy(Males)
```

#Exploratory Data Analysis
Is there a relationship with Marriage and Wage?
```{r}
Males %>% 
  ggplot(aes(x = married,
             y = wage))+
  geom_boxplot()
```
Medians and range do appear significantly different.

Let's make data synchronic:
```{r}
temp <- Males %>%
  replace_na() %>%
  filter(year == "1980")

mean(temp$wage)

Males %>% 
  replace_na() %>% 
  filter(year == "1980") %>% 
  select(wage) %>% 
  summary()
```

```{r}
Males %>% 
  group_by(year) %>% 
  summarize(Mean = mean(wage)) %>% 
  ggplot(aes(x = year,
             y = Mean))+
  geom_line()
```

#Questions to explore about dataset

## How does each males' wage change from beginning of study (1980) and end of study (1987)

###Check assumption:

1) Random sampling - yes assummed to be random
2) Independent sampling - no, that is why we are doing paired t test
3) Equal variances - Variances do not appear to be equal.
4) Normality - From the qq plot, it appears that year 1980 is non normal.

```{r}
# extrapolate the data from each year
males1980 <- Males %>%
  filter(year == 1980)

males1987 <- Males %>%
  filter(year == 1987)

# plot qq plots
males1980 %>%
  ggplot(aes(sample = wage)) +
  geom_qq() +
  geom_qq_line()

males1987 %>%
  ggplot(aes(sample = wage)) +
  geom_qq() +
  geom_qq_line()

var(males1980$wage)
var(males1987$wage)

wilcox.test(males1980$wage, males1987$wage, paired = TRUE)
```
The p value was 2.2e-16 which is very small compared to alpha = 0.05. Therefore we reject the null hypothesis. The wage difference from the beginning (1980) and the end (1987) is significant.
